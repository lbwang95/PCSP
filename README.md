# PCSP: Efficiently Answering Label-Constrained Shortest Path Queries on Road Networks

This repository contains the code and data for this manuscript.

### Environment

g++ version: 9.4.0 

OS: Ubuntu/CentOS

### Compilation

cd code

make

### Execution

In the folder code/, there are three algorithms, Dijkstra, LSD, and PCSP, which can be executed by the following commands.

./PCSP [network name] [query file name] [regular expression] [K]

./LSD [network name] [query file name] [regular expression] 

./Dijkstra [network name] [query file name] [regular expression]

The default command is "./PCSP NYC q1 A2\\\*D1\\\*A2\\\* 10". Note that we need to use the escape character "\\" before *, |, (, ). The network name can be NYC, BAY, COL, FLA, and exa, where the last one represents the network of the toy example in our paper. For query files, the algorithms will automatically run q1-q10 (as introduced in our experimental section) stored in each network folder "data/[network name]/". The regular expression uses *, |, (, ) for all operations, and the alphabet $\Sigma=\{A1, A2, A3, A4, A5, B1, B2, B3, B4, B5, C1, C2, C3, C4, C5, D1, D2, D3, D4, D5\}$. For the toy example in our paper, $A2, A3, D1$ stand for $b, c, y$ (bike, car, and subway), respectively. The last parameter K denotes the number of pruned separators. The default settings in our experiments use the following three commands (detailed in our paper).

./PCSP NYC q1 \\(D1\\|C1\\|B1\\|B5\\|A5\\|A1\\|D5\\|C5\\|D3\\|A3\\)\\* 10

./LSD NYC q1 \\(D1\\|C1\\|B1\\|B5\\|A5\\|A1\\|D5\\|C5\\|D3\\|A3\\)\\*

./Dijkstra NYC q1 \\(D1\\|C1\\|B1\\|B5\\|A5\\|A1\\|D5\\|C5\\|D3\\|A3\\)\\*

When the algorithm is executed, the screen will output auxiliary information, including the DFA states, transition functions, tree time, indexing time, index size, etc. For each query file, it will show the query time in microseconds. The query answers are stored in the folder "data/[network name]/".

### Datasets

All the data used in the experiments are stored in the folder "data/". Under it, there is a folder for each network. 

In each folder, the file "USA-road-l.[network name].gr" contains the road network data. It basically follows the format of DIMACS (http://www.dis.uniroma1.it/~challenge9). The fifth and sixth lines show the numbers of vertices and edges. From Line 8 to the last line, each line gives the information of an edge in the form of "a [source vertex id] [destination vertex id] [edge distance] [edge label]".

The files "q1"-"q10" are the query datasets, as introduced in our paper. Each line specifies the source id and destination id of a query.

The file "order.txt" gives a vertex order used to build the tree decomposition. The i-th line specifies the rank of the i-th vertex. This order can also be generated by the function "genorder(string filename, bool writeflag)" in the cpp file of PCSP, where the first parameter is the filename to record the order, and the second one indicates whether we write the file.

